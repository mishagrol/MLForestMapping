
# Forest species mapping supported with machine learning

__Source code for paper related to forest species mapping supported with machine learning using spectral, terrain and texture features__

We observed the influence of various feature types, including values of initial bands, vegetation indices, terrain features and texture features on the performance of popular machine learning algorithms, namely Random Forest, Support Vector Machine, eXtreme Gradient Boosting and kNN

Map demonstrate classified forest map by Ridge Regression

![Forest mapping](/plots/result_maps.png)

## Installation

Clone this repository

Install python packages

* matplotlib
* numpy 
* seaborn 
* sklearn
* pandas 
* ipython
* jupyter


## How to run in Jupyter? Easy! 
> requirement - Docker 🐳
>
1. Clone repository to your local machine 
`git clone https://github.com/mishagrol/MLForestMapping.git`
2. Go to folder
`cd MLForestMapping`
3. Run Jupyter in Docker
`bash run_in_docker.sh`
4. Open Jupyter in browser at `localhost:8890`, token is `SecretToken`

## Data 

### Inventory plots data

Availdable by request - mikhail.gasanov[@]skoltech.ru

### Sentinel2 L2A data

2019 year data [Y.Disk](https://disk.yandex.ru/d/QKyDnvVduTOigw)

2020 year data [Y.Disk](https://disk.yandex.ru/d/UnhFTwZ9jhWasw)

### Terrain data

Freely available SRTM 

### Texture data

Texture features generated by `EO-learn` package - https://github.com/sentinel-hub/eo-learn

## Source Code

`Model_Train.ipynb` -  jupyter to conduct ML model training with satellite data, spectral, texture and terrain features

`Inference.ipynb` -  jupyter to conduct inference of best models to recieve pixel-wise forest and UQ maps

`SHAP.ipynb` -  jupyter to conduct SHAP-analysis of pretrained ML models


### Plots

BarPlots, Maps and other visualization created with python.

To reproduce plots install python package 

* SciencePlots

## License

Distributed under the MIT license. See ``LICENSE`` for more information.
